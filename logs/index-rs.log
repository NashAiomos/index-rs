[2025-05-01 19:15:30] [INFO] - =======================================
[2025-05-01 19:15:30] [INFO] - ==============  服务启动  ==============
[2025-05-01 19:15:30] [INFO] - =======================================
[2025-05-01 19:15:30] [INFO] - 正在启动区块链索引服务...
[2025-05-01 19:15:30] [INFO] - 启动索引服务...
[2025-05-01 19:15:30] [INFO] - 初始化MongoDB连接: mongodb://localhost:27017
[2025-05-01 19:15:30] [INFO] - 已连接到MongoDB
[2025-05-01 19:15:30] [INFO] - IC Agent初始化完成，连接到: https://icp0.io
[2025-05-01 19:15:30] [INFO] - 使用配置文件中指定的代币小数位: 6
[2025-05-01 19:15:30] [INFO] - 代币小数位设置为: 6
[2025-05-01 19:15:30] [INFO] - 创建或确认数据库索引...
[2025-05-01 19:15:30] [INFO] - 交易索引创建成功
[2025-05-01 19:15:30] [INFO] - 账户索引创建成功
[2025-05-01 19:15:30] [INFO] - 余额索引创建成功
[2025-05-01 19:15:30] [INFO] - 同步状态索引创建成功
[2025-05-01 19:15:30] [INFO] - 未找到同步状态记录，将进行初始同步
[2025-05-01 19:15:30] [INFO] - 阶段1：同步所有交易数据...
[2025-05-01 19:15:30] [INFO] - 获取归档信息...
[2025-05-01 19:15:30] [INFO] - 获取归档信息...
[2025-05-01 19:15:31] [INFO] - 发现 1 个归档 canister，将依次同步
[2025-05-01 19:15:31] [INFO] - 处理归档 1/1: canister_id=b4lia-7yaaa-aaaaj-az7uq-cai
[2025-05-01 19:15:32] [INFO] - 成功获取到归档交易批次：0-1999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:15:39] [INFO] - 成功获取到归档交易批次：2000-3999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:15:47] [INFO] - 成功获取到归档交易批次：4000-5999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:15:55] [INFO] - 成功获取到归档交易批次：6000-7999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:16:05] [INFO] - 成功获取到归档交易批次：8000-9999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:16:16] [INFO] - 成功获取到归档交易批次：10000-11999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:16:27] [INFO] - 成功获取到归档交易批次：12000-13999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:16:39] [INFO] - 成功获取到归档交易批次：14000-15999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:16:53] [INFO] - 成功获取到归档交易批次：16000-17999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:17:07] [INFO] - 成功获取到归档交易批次：18000-19999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:17:21] [INFO] - 成功获取到归档交易批次：20000-20999，使用SimpleTransactionRange解码，已保存到数据库
[2025-05-01 19:17:28] [INFO] - 归档同步完成，共同步 21000 笔归档交易
[2025-05-01 19:17:28] [INFO] - 开始同步ledger交易...
[2025-05-01 19:17:28] [INFO] - 数据库中最新的交易索引: 20999
[2025-05-01 19:17:28] [INFO] - 从索引 21000 开始同步新交易
[2025-05-01 19:17:29] [INFO] - 成功获取到主账本交易批次：21000-22999，使用LedgerGetTransactionsResult解码，已保存到数据库
[2025-05-01 19:17:29] [INFO] - 获取到 2000 笔交易
[2025-05-01 19:17:37] [INFO] - 成功保存 2000 笔交易，失败 0 笔
[2025-05-01 19:17:37] [INFO] - 设置为增量同步模式，最新索引: 22999
[2025-05-01 19:17:37] [INFO] - 同步状态已更新: 索引 22999, 时间戳 1745758145051705919, 模式 incremental
[2025-05-01 19:17:37] [INFO] - 已更新同步状态索引: 20999 -> 22999
[2025-05-01 19:17:38] [INFO] - 成功获取到主账本交易批次：23000-23734，使用LedgerGetTransactionsResult解码，已保存到数据库
[2025-05-01 19:17:38] [INFO] - 获取到 735 笔交易
[2025-05-01 19:17:40] [INFO] - 成功保存 735 笔交易，失败 0 笔
[2025-05-01 19:17:40] [INFO] - 设置为增量同步模式，最新索引: 23734
[2025-05-01 19:17:40] [INFO] - 同步状态已更新: 索引 23734, 时间戳 1746097703093505506, 模式 incremental
[2025-05-01 19:17:40] [INFO] - 已更新同步状态索引: 22999 -> 23734
[2025-05-01 19:17:47] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-01 19:17:47] [INFO] - 设置为增量同步模式，最新索引: 23734
[2025-05-01 19:17:47] [INFO] - 同步状态已更新: 索引 23734, 时间戳 1746097703093505506, 模式 incremental
[2025-05-01 19:17:47] [INFO] - 同步状态已更新至最新索引: 23734 (共同步 2735 笔新交易)
[2025-05-01 19:17:47] [INFO] - 交易同步完成，当前索引: 24334, 共同步 2735 笔新交易
[2025-05-01 19:17:47] [INFO] - 阶段2：根据账户交易记录统一计算余额...
[2025-05-01 19:17:47] [INFO] - 开始使用新算法计算所有账户余额...
[2025-05-01 19:17:47] [INFO] - 开始计算所有账户余额...
[2025-05-01 19:17:47] [INFO] - 已清除 1 条余额记录
[2025-05-01 19:18:31] [INFO] - 全量余额计算完成: 处理 22101 个账户, 失败 0 个账户, 检测到 0 个余额异常
[2025-05-01 19:18:31] [INFO] - 已重新计算并更新总供应量: 17_434_328_859
[2025-05-01 19:18:31] [INFO] - 余额计算完成: 成功处理 22101 个账户, 失败 0 个账户
[2025-05-01 19:18:31] [INFO] - 所有账户的余额计算已完成
[2025-05-01 19:18:31] [INFO] - 设置增量同步起点为最后一笔交易索引: 23734
[2025-05-01 19:18:31] [INFO] - 设置为增量同步模式，最新索引: 23734
[2025-05-01 19:18:31] [INFO] - 同步状态已更新: 索引 23734, 时间戳 1746097703093505506, 模式 incremental
[2025-05-01 19:18:31] [INFO] - 初始同步和余额计算完成，将开始实时监控新交易
[2025-05-01 19:18:31] [INFO] - 配置中启用了API服务器，即将启动...
[2025-05-01 19:18:31] [INFO] - API服务器已在后台启动，端口: 3000
[2025-05-01 19:18:31] [INFO] - 开始实时监控新交易
[2025-05-01 19:18:31] [INFO] - 启动API服务器，端口: 3000
[2025-05-01 19:18:31] [INFO] - Server::run; addr=0.0.0.0:3000
[2025-05-01 19:18:31] [INFO] - listening on http://0.0.0.0:3000
[2025-05-01 19:18:31] [INFO] - 数据库中最新的交易索引: 23734
[2025-05-01 19:18:31] [INFO] - 从索引 23735 开始同步新交易
[2025-05-01 19:18:38] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-01 19:18:38] [INFO] - 无新交易，保持同步状态在索引: 23734
[2025-05-01 19:18:38] [INFO] - 交易同步完成，当前索引: 24334, 共同步 0 笔新交易
[2025-05-01 19:18:38] [INFO] - 数据库中最新的交易索引: 23734
[2025-05-01 19:18:38] [INFO] - 从索引 23735 开始同步新交易
[2025-05-01 19:18:46] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-01 19:18:46] [INFO] - 无新交易，保持同步状态在索引: 23734
[2025-05-01 19:18:46] [INFO] - 交易同步完成，当前索引: 24334, 共同步 0 笔新交易
[2025-05-01 19:18:46] [INFO] - 数据库中最新的交易索引: 23734
[2025-05-01 19:18:46] [INFO] - 从索引 23735 开始同步新交易
[2025-05-06 10:10:25] [INFO] - =======================================
[2025-05-06 10:10:25] [INFO] - ==============  服务启动  ==============
[2025-05-06 10:10:25] [INFO] - =======================================
[2025-05-06 10:10:25] [INFO] - 正在启动区块链索引服务...
[2025-05-06 10:10:25] [INFO] - 启动索引服务...
[2025-05-06 10:10:25] [INFO] - 初始化MongoDB连接: mongodb://localhost:27017
[2025-05-06 10:10:25] [INFO] - 已连接到MongoDB
[2025-05-06 10:10:25] [INFO] - IC Agent初始化完成，连接到: https://icp0.io
[2025-05-06 10:10:25] [INFO] - 使用配置文件中指定的代币小数位: 6
[2025-05-06 10:10:25] [INFO] - 代币小数位设置为: 6
[2025-05-06 10:10:25] [INFO] - 创建或确认数据库索引...
[2025-05-06 10:10:25] [INFO] - 交易索引创建成功
[2025-05-06 10:10:25] [INFO] - 账户索引创建成功
[2025-05-06 10:10:25] [INFO] - 余额索引创建成功
[2025-05-06 10:10:25] [INFO] - 同步状态索引创建成功
[2025-05-06 10:10:25] [INFO] - 检测到有效的同步状态，上次同步索引：23734，上次同步时间：2025-05-01 11:18:31，将继续增量同步
[2025-05-06 10:10:25] [INFO] - 从断点继续同步，验证同步状态的完整性...
[2025-05-06 10:10:25] [INFO] - 同步状态与数据库记录一致，索引: 23734
[2025-05-06 10:10:25] [INFO] - 跳过初始同步，直接进入增量同步模式
[2025-05-06 10:10:25] [INFO] - 配置中启用了API服务器，即将启动...
[2025-05-06 10:10:25] [INFO] - API服务器已在后台启动，端口: 3000
[2025-05-06 10:10:25] [INFO] - 开始实时监控新交易
[2025-05-06 10:10:25] [INFO] - 启动API服务器，端口: 3000
[2025-05-06 10:10:25] [INFO] - Server::run; addr=0.0.0.0:3000
[2025-05-06 10:10:25] [INFO] - listening on http://0.0.0.0:3000
[2025-05-06 10:10:25] [INFO] - 数据库中最新的交易索引: 23734
[2025-05-06 10:10:25] [INFO] - 从索引 23735 开始同步新交易
[2025-05-06 10:10:26] [INFO] - 成功获取到主账本交易批次：23735-24172，使用LedgerGetTransactionsResult解码，已保存到数据库
[2025-05-06 10:10:26] [INFO] - 获取到 438 笔交易
[2025-05-06 10:10:27] [INFO] - 成功保存 438 笔交易，失败 0 笔
[2025-05-06 10:10:27] [INFO] - 设置为增量同步模式，最新索引: 24172
[2025-05-06 10:10:27] [INFO] - 同步状态已更新: 索引 24172, 时间戳 1746463819461978395, 模式 incremental
[2025-05-06 10:10:27] [INFO] - 已更新同步状态索引: 23734 -> 24172
[2025-05-06 10:10:34] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-06 10:10:34] [INFO] - 设置为增量同步模式，最新索引: 24172
[2025-05-06 10:10:34] [INFO] - 同步状态已更新: 索引 24172, 时间戳 1746463819461978395, 模式 incremental
[2025-05-06 10:10:34] [INFO] - 同步状态已更新至最新索引: 24172 (共同步 438 笔新交易)
[2025-05-06 10:10:34] [INFO] - 交易同步完成，当前索引: 24772, 共同步 438 笔新交易
[2025-05-06 10:10:34] [INFO] - 增量同步获取到 438 笔新交易，计算相关账户余额...
[2025-05-06 10:10:34] [INFO] - 开始增量计算余额，共 438 笔新交易
[2025-05-06 10:10:36] [INFO] - 增量余额计算完成: 更新 361 个账户, 失败 0 个账户, 检测到 0 个余额异常
[2025-05-06 10:10:36] [INFO] - 已重新计算并更新总供应量: 17_262_592_151
[2025-05-06 10:10:36] [INFO] - 增量余额计算完成: 更新了 361 个账户, 失败 0 个账户
[2025-05-06 10:10:36] [INFO] - 从同步状态恢复，上次同步到索引: 24172
[2025-05-06 10:10:36] [INFO] - 验证同步点附近交易的完整性，从索引 24152 开始检查 20 条记录
[2025-05-06 10:10:36] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 10:10:36] [INFO] - 同步点验证成功，将从索引 24173 继续同步
[2025-05-06 10:10:36] [INFO] - 使用同步状态中的索引: 24172
[2025-05-06 10:10:43] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-06 10:10:43] [INFO] - 无新交易，保持同步状态在索引: 24172
[2025-05-06 10:10:43] [INFO] - 交易同步完成，当前索引: 24772, 共同步 0 笔新交易
[2025-05-06 10:10:43] [INFO] - 从同步状态恢复，上次同步到索引: 24172
[2025-05-06 10:10:43] [INFO] - 验证同步点附近交易的完整性，从索引 24152 开始检查 20 条记录
[2025-05-06 10:10:43] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 10:10:43] [INFO] - 同步点验证成功，将从索引 24173 继续同步
[2025-05-06 10:10:43] [INFO] - 使用同步状态中的索引: 24172
[2025-05-06 10:10:50] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-06 10:10:50] [INFO] - 无新交易，保持同步状态在索引: 24172
[2025-05-06 10:10:50] [INFO] - 交易同步完成，当前索引: 24772, 共同步 0 笔新交易
[2025-05-06 10:10:50] [INFO] - 从同步状态恢复，上次同步到索引: 24172
[2025-05-06 10:10:50] [INFO] - 验证同步点附近交易的完整性，从索引 24152 开始检查 20 条记录
[2025-05-06 10:10:50] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 10:10:50] [INFO] - 同步点验证成功，将从索引 24173 继续同步
[2025-05-06 10:10:50] [INFO] - 使用同步状态中的索引: 24172
[2025-05-06 10:10:57] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-06 10:10:57] [INFO] - 无新交易，保持同步状态在索引: 24172
[2025-05-06 10:10:57] [INFO] - 交易同步完成，当前索引: 24772, 共同步 0 笔新交易
[2025-05-06 10:10:57] [INFO] - 从同步状态恢复，上次同步到索引: 24172
[2025-05-06 10:10:57] [INFO] - 验证同步点附近交易的完整性，从索引 24152 开始检查 20 条记录
[2025-05-06 10:10:57] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 10:10:57] [INFO] - 同步点验证成功，将从索引 24173 继续同步
[2025-05-06 10:10:57] [INFO] - 使用同步状态中的索引: 24172
[2025-05-06 17:43:29] [INFO] - =======================================
[2025-05-06 17:43:29] [INFO] - ==============  服务启动  ==============
[2025-05-06 17:43:29] [INFO] - =======================================
[2025-05-06 17:43:29] [INFO] - 正在启动区块链索引服务...
[2025-05-06 17:43:29] [INFO] - 启动索引服务...
[2025-05-06 17:43:29] [INFO] - 初始化MongoDB连接: mongodb://localhost:27017
[2025-05-06 17:43:29] [INFO] - 已连接到MongoDB
[2025-05-06 17:43:29] [INFO] - IC Agent初始化完成，连接到: https://icp0.io
[2025-05-06 17:43:29] [INFO] - 使用配置文件中指定的代币小数位: 6
[2025-05-06 17:43:29] [INFO] - 代币小数位设置为: 6
[2025-05-06 17:43:29] [INFO] - 创建或确认数据库索引...
[2025-05-06 17:43:29] [INFO] - 交易索引创建成功
[2025-05-06 17:43:29] [INFO] - 账户索引创建成功
[2025-05-06 17:43:29] [INFO] - 余额索引创建成功
[2025-05-06 17:43:29] [INFO] - 同步状态索引创建成功
[2025-05-06 17:43:29] [INFO] - 检测到有效的同步状态，上次同步索引：24182，上次同步时间：2025-05-06 09:29:57，将继续增量同步
[2025-05-06 17:43:29] [INFO] - 从断点继续同步，验证同步状态的完整性...
[2025-05-06 17:43:29] [INFO] - 同步状态与数据库记录一致，索引: 24182
[2025-05-06 17:43:29] [INFO] - 跳过初始同步，直接进入增量同步模式
[2025-05-06 17:43:29] [INFO] - 配置中启用了API服务器，即将启动...
[2025-05-06 17:43:29] [INFO] - API服务器已在后台启动，端口: 3000
[2025-05-06 17:43:29] [INFO] - 开始实时监控新交易
[2025-05-06 17:43:29] [INFO] - 启动API服务器，端口: 3000
[2025-05-06 17:43:29] [INFO] - Server::run; addr=0.0.0.0:3000
[2025-05-06 17:43:29] [INFO] - listening on http://0.0.0.0:3000
[2025-05-06 17:43:29] [INFO] - 从同步状态恢复，上次同步到索引: 24182
[2025-05-06 17:43:29] [INFO] - 验证同步点附近交易的完整性，从索引 24162 开始检查 20 条记录
[2025-05-06 17:43:29] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 17:43:29] [INFO] - 同步点验证成功，将从索引 24183 继续同步
[2025-05-06 17:43:29] [INFO] - 使用同步状态中的索引: 24182
[2025-05-06 17:43:33] [INFO] - 127.0.0.1:60418 "GET /api/transactions/5667a-dzhlm-w6u3z-fq2o5-lmjho-yrkdy-idhr6-6n3jx-gg4u7-fmbqg-4qe HTTP/1.1" 200 "-" "Apifox/1.0.0 (https://apifox.com)" 8.7686ms
[2025-05-06 17:43:36] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-05-06 17:43:36] [INFO] - 无新交易，保持同步状态在索引: 24182
[2025-05-06 17:43:36] [INFO] - 交易同步完成，当前索引: 24782, 共同步 0 笔新交易
[2025-05-06 17:43:36] [INFO] - 从同步状态恢复，上次同步到索引: 24182
[2025-05-06 17:43:36] [INFO] - 验证同步点附近交易的完整性，从索引 24162 开始检查 20 条记录
[2025-05-06 17:43:36] [INFO] - 同步点附近交易验证成功，数据完整性正常
[2025-05-06 17:43:36] [INFO] - 同步点验证成功，将从索引 24183 继续同步
[2025-05-06 17:43:36] [INFO] - 使用同步状态中的索引: 24182
