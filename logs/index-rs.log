[2025-04-29 09:46:16] [INFO] - =======================================
[2025-04-29 09:46:16] [INFO] - ==============  服务启动  ==============
[2025-04-29 09:46:16] [INFO] - =======================================
[2025-04-29 09:46:16] [INFO] - 正在启动区块链索引服务...
[2025-04-29 09:46:16] [INFO] - 启动索引服务...
[2025-04-29 09:46:16] [INFO] - 初始化MongoDB连接: mongodb://localhost:27017
[2025-04-29 09:46:16] [INFO] - 已连接到MongoDB
[2025-04-29 09:46:16] [INFO] - IC Agent初始化完成，连接到: https://icp0.io
[2025-04-29 09:46:16] [INFO] - 使用配置文件中指定的代币小数位: 6
[2025-04-29 09:46:16] [INFO] - 代币小数位设置为: 6
[2025-04-29 09:46:16] [INFO] - 创建或确认数据库索引...
[2025-04-29 09:46:16] [INFO] - 交易索引创建成功
[2025-04-29 09:46:16] [INFO] - 账户索引创建成功
[2025-04-29 09:46:16] [INFO] - 余额索引创建成功
[2025-04-29 09:46:16] [INFO] - 同步状态索引创建成功
[2025-04-29 09:46:16] [INFO] - 未找到同步状态记录，将进行初始同步
[2025-04-29 09:46:16] [INFO] - 阶段1：同步所有交易数据...
[2025-04-29 09:46:16] [INFO] - 获取归档信息...
[2025-04-29 09:46:16] [INFO] - 获取归档信息...
[2025-04-29 09:46:18] [INFO] - 发现 1 个归档 canister，将依次同步
[2025-04-29 09:46:18] [INFO] - 处理归档 1/1: canister_id=b4lia-7yaaa-aaaaj-az7uq-cai
[2025-04-29 09:46:20] [INFO] - 成功获取到归档交易批次：0-1999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:46:29] [INFO] - 成功获取到归档交易批次：2000-3999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:46:41] [INFO] - 成功获取到归档交易批次：4000-5999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:46:56] [INFO] - 成功获取到归档交易批次：6000-7999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:47:13] [INFO] - 成功获取到归档交易批次：8000-9999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:47:32] [INFO] - 成功获取到归档交易批次：10000-11999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:47:54] [INFO] - 成功获取到归档交易批次：12000-13999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:48:15] [INFO] - 成功获取到归档交易批次：14000-15999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:48:40] [INFO] - 成功获取到归档交易批次：16000-17999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:49:07] [INFO] - 成功获取到归档交易批次：18000-19999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:49:34] [INFO] - 成功获取到归档交易批次：20000-20999，使用SimpleTransactionRange解码，已保存到数据库
[2025-04-29 09:49:48] [INFO] - 归档同步完成，共同步 21000 笔归档交易
[2025-04-29 09:49:48] [INFO] - 开始同步ledger交易...
[2025-04-29 09:49:48] [INFO] - 数据库中最新的交易索引: 20999
[2025-04-29 09:49:48] [INFO] - 从索引 21000 开始同步新交易
[2025-04-29 09:49:50] [INFO] - 成功获取到主账本交易批次：21000-22999，使用LedgerGetTransactionsResult解码，已保存到数据库
[2025-04-29 09:49:50] [INFO] - 获取到 2000 笔交易
[2025-04-29 09:50:05] [INFO] - 成功保存 2000 笔交易，失败 0 笔
[2025-04-29 09:50:05] [INFO] - 设置为增量同步模式，最新索引: 22999
[2025-04-29 09:50:05] [INFO] - 同步状态已更新: 索引 22999, 时间戳 1745758145051705919, 模式 incremental
[2025-04-29 09:50:05] [INFO] - 已更新同步状态索引: 20999 -> 22999
[2025-04-29 09:50:07] [INFO] - 成功获取到主账本交易批次：23000-23073，使用LedgerGetTransactionsResult解码，已保存到数据库
[2025-04-29 09:50:07] [INFO] - 获取到 74 笔交易
[2025-04-29 09:50:08] [INFO] - 成功保存 74 笔交易，失败 0 笔
[2025-04-29 09:50:08] [INFO] - 设置为增量同步模式，最新索引: 23073
[2025-04-29 09:50:08] [INFO] - 同步状态已更新: 索引 23073, 时间戳 1745873321237345171, 模式 incremental
[2025-04-29 09:50:08] [INFO] - 已更新同步状态索引: 22999 -> 23073
[2025-04-29 09:50:15] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-04-29 09:50:15] [INFO] - 设置为增量同步模式，最新索引: 23073
[2025-04-29 09:50:15] [INFO] - 同步状态已更新: 索引 23073, 时间戳 1745873321237345171, 模式 incremental
[2025-04-29 09:50:15] [INFO] - 同步状态已更新至最新索引: 23073 (共同步 2074 笔新交易)
[2025-04-29 09:50:15] [INFO] - 交易同步完成，当前索引: 23673, 共同步 2074 笔新交易
[2025-04-29 09:50:15] [INFO] - 阶段2：根据账户交易记录统一计算余额...
[2025-04-29 09:50:15] [INFO] - 开始使用新算法计算所有账户余额...
[2025-04-29 09:50:15] [INFO] - 开始计算所有账户余额...
[2025-04-29 09:50:15] [INFO] - 已清除 1 条余额记录
[2025-04-29 09:51:21] [INFO] - 全量余额计算完成: 处理 21767 个账户, 失败 0 个账户, 检测到 0 个余额异常
[2025-04-29 09:51:22] [INFO] - 已重新计算并更新总供应量: 17_533_272_217
[2025-04-29 09:51:22] [INFO] - 余额计算完成: 成功处理 21767 个账户, 失败 0 个账户
[2025-04-29 09:51:22] [INFO] - 所有账户的余额计算已完成
[2025-04-29 09:51:22] [INFO] - 设置增量同步起点为最后一笔交易索引: 23073
[2025-04-29 09:51:22] [INFO] - 设置为增量同步模式，最新索引: 23073
[2025-04-29 09:51:22] [INFO] - 同步状态已更新: 索引 23073, 时间戳 1745873321237345171, 模式 incremental
[2025-04-29 09:51:22] [INFO] - 初始同步和余额计算完成，将开始实时监控新交易
[2025-04-29 09:51:22] [INFO] - 配置中启用了API服务器，即将启动...
[2025-04-29 09:51:22] [INFO] - API服务器已在后台启动，端口: 3000
[2025-04-29 09:51:22] [INFO] - 开始实时监控新交易
[2025-04-29 09:51:22] [INFO] - 启动API服务器，端口: 3000
[2025-04-29 09:51:22] [INFO] - Server::run; addr=0.0.0.0:3000
[2025-04-29 09:51:22] [INFO] - listening on http://0.0.0.0:3000
[2025-04-29 09:51:22] [INFO] - 数据库中最新的交易索引: 23073
[2025-04-29 09:51:22] [INFO] - 从索引 23074 开始同步新交易
[2025-04-29 09:51:30] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-04-29 09:51:30] [INFO] - 无新交易，保持同步状态在索引: 23073
[2025-04-29 09:51:30] [INFO] - 交易同步完成，当前索引: 23673, 共同步 0 笔新交易
[2025-04-29 09:51:30] [INFO] - 数据库中最新的交易索引: 23073
[2025-04-29 09:51:30] [INFO] - 从索引 23074 开始同步新交易
[2025-04-29 09:51:38] [INFO] - 连续 3 次获取空结果，认为已达到链上最新状态
[2025-04-29 09:51:38] [INFO] - 无新交易，保持同步状态在索引: 23073
[2025-04-29 09:51:38] [INFO] - 交易同步完成，当前索引: 23673, 共同步 0 笔新交易
[2025-04-29 09:51:38] [INFO] - 数据库中最新的交易索引: 23073
[2025-04-29 09:51:38] [INFO] - 从索引 23074 开始同步新交易
